import{r as a,j as t,P as c,T as s,w as i,I as D,x as C}from"./index-Dbp6cY2J.js";import{S as L,C as E}from"./CustomPagination-CmLdiBRs.js";import{u as N,D as T}from"./DataGrid-B0QCrr4f.js";import"./IconifyIcon-CVzshvhH.js";import"./TextField-CHFAi5Wa.js";import"./Menu-BX0TDKzG.js";import"./Toolbar-Cy1yNAeb.js";import"./Divider-BnrKH_WB.js";import"./InputAdornment-BYBFXy2L.js";import"./Button-BL7aqzdx.js";import"./Checkbox-COksgwjS.js";import"./colorManipulator-DQXk7iNs.js";const $=()=>[{flex:1,sortable:!1,renderCell:n=>t.jsxs(i,{sx:{pt:2},children:[t.jsx(s,{variant:"subtitle2",fontWeight:"bold",sx:{cursor:"pointer",transition:"color 0.2s",textTransform:"capitalize",fontSize:16,"&:hover":{color:"primary.main"}},children:n.row.name}),t.jsx(s,{variant:"body2",color:"text.secondary",noWrap:!0,sx:{cursor:"pointer"},children:n.row.lastMessage})]})}],Y=()=>{const n=N(),[d,w]=a.useState([]),[x,g]=a.useState(!0),[p,m]=a.useState(!1),[o,b]=a.useState(null),[u,f]=a.useState([]),[y,S]=a.useState(""),v=$(),k=async(e="")=>{g(!0);try{const r=localStorage.getItem("authToken"),h=(await C.get(`http://172.236.30.193:8008/api/chat/chatlist?search=${e}`,{headers:{Authorization:`Bearer ${r}`}})).data.data.map((j,z)=>({...j,id:j.id||z}));w(h)}catch(r){console.error("Error fetching chat logs:",r)}finally{g(!1)}};a.useEffect(()=>{k(y)},[y]);const I=async e=>{const r=e.userId;b(e),m(!0);try{const l=localStorage.getItem("authToken"),h=await C.get(`http://172.236.30.193:8008/api/chat?id=${r}`,{headers:{Authorization:`Bearer ${l}`}});f(h.data.data),m(!1)}catch(l){console.error("Error fetching single chat:",l),f([])}};return a.useEffect(()=>{console.log("Selected chat changed:",o)},[o]),t.jsx(t.Fragment,{children:d.length===0&&x===!1?t.jsxs(c,{sx:{width:"100%",p:2,textAlign:"center",height:"85vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[t.jsx("img",{src:"https://cdn-icons-png.flaticon.com/512/6134/6134065.png",alt:"No Chats",width:120,style:{opacity:.6,marginBottom:16}}),t.jsx(s,{variant:"h6",color:"text.secondary",children:"No chats found"})]}):t.jsxs(i,{sx:{display:"flex",height:"60vh"},children:[t.jsxs(c,{sx:{width:"35%",p:2},className:"chat-list-page",children:[t.jsx(s,{variant:"h5",color:"primary.dark",mb:3,children:"Chats"}),t.jsx(L,{apiRef:n,sx:{maxWidth:300},onChange:e=>{const r=e.target.value;S(r)}}),t.jsx(i,{sx:{mb:2,"& .MuiDataGrid-columnHeaders":{display:"none"},"& .active-chat-row":{backgroundColor:"#e3f2fd","&:hover":{backgroundColor:"#bbdefb"}}},children:t.jsx(T,{apiRef:n,rows:d,columns:v,loading:x,pageSizeOptions:[5,10],disableDensitySelector:!0,hideFooterPagination:!0,onRowClick:e=>I(e.row),getRowClassName:e=>e.row.chatId===(o==null?void 0:o.userId)?"active-chat-row":""})}),t.jsx(E,{apiRef:n})]}),t.jsx(i,{sx:{flexGrow:1,p:3,backgroundColor:"#f7f7f7",width:"70%"},children:p?t.jsx(i,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mt:2,height:"60vh"},children:t.jsx(D,{size:30,color:"primary"})}):o&&!p?t.jsxs(t.Fragment,{children:[t.jsxs(s,{variant:"h6",color:"primary",mb:2,sx:{textTransform:"capitalize"},children:["Chat with: ",o.name||"Unknown User"]}),t.jsx(i,{sx:{display:"flex",flexDirection:"column",height:"50vh",overflowY:"auto",pr:1},children:u.length>0?u.map((e,r)=>t.jsxs(t.Fragment,{children:[e.text&&t.jsx(c,{sx:{p:1.5,my:1,maxWidth:"75%",alignSelf:"flex-start",backgroundColor:"#e3f2fd"},children:t.jsx(s,{variant:"body2",children:e.text})},`text-${r}`),e.reply&&t.jsx(c,{sx:{p:1.5,my:1,maxWidth:"75%",alignSelf:"flex-end",backgroundColor:"#c8e6c9"},children:t.jsx(s,{variant:"body2",children:e.reply})},`reply-${r}`)]})):t.jsx(s,{color:"text.secondary",children:"No chat messages found."})})]}):t.jsx(c,{sx:{backgroundColor:"transparent",boxShadow:"none",width:"100%",p:0,m:0,textAlign:"center",height:"60vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:t.jsx("img",{src:"./public/imgs/messenger-concept-illustration_1.png",alt:"No Chats",width:380,style:{marginBottom:16}})})})]})})};export{Y as default};
