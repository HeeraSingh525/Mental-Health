import{r as i,v as $,j as e,P as z,S as B,T as y,w as N,I as _,x as P}from"./index-Dbp6cY2J.js";import{E as L,D as V}from"./Edit-p0oQH28y.js";import{V as F}from"./Visibility-BbAx8QFw.js";import{u as G,D as R,T as d}from"./DataGrid-B0QCrr4f.js";import{B as h}from"./Button-BL7aqzdx.js";import{D as H,a as M,b as O,c as W,d as q}from"./DialogTitle-BcKG4VFi.js";import{S as J,A as K}from"./Snackbar-Dz79FgWn.js";import{I as f}from"./Menu-BX0TDKzG.js";import"./TextField-CHFAi5Wa.js";import"./Toolbar-Cy1yNAeb.js";import"./Divider-BnrKH_WB.js";import"./InputAdornment-BYBFXy2L.js";import"./Checkbox-COksgwjS.js";import"./colorManipulator-DQXk7iNs.js";import"./useSlot-DopozSqz.js";const de=()=>{const[k,p]=i.useState([]),[w,m]=i.useState(!1),[x,u]=i.useState(""),[S,o]=i.useState(!1),[g,A]=i.useState(),I=G(),l=$(),[r,j]=i.useState({open:!1,message:"",severity:"success",vertical:"top",horizontal:"right"});i.useEffect(()=>{(async()=>{var s,a;m(!0),u("");try{const n=localStorage.getItem("authToken"),c=await P.get("http://172.236.30.193:8008/api/plan",{headers:{Authorization:`Bearer ${n}`}});p(c.data.data)}catch(n){u(((a=(s=n.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to fetch plans")}finally{m(!1)}})()},[]);const C=({vertical:t="top",horizontal:s="right",message:a,severity:n})=>{j({open:!0,message:a,severity:n,vertical:t,horizontal:s})},D=()=>{j(t=>({...t,open:!1}))},b=()=>{o(!0)},v=()=>{o(!1)},T=async()=>{var t,s;try{const a=localStorage.getItem("authToken");await P.delete(`http://172.236.30.193:8008/api/plan/${g}`,{headers:{Authorization:`Bearer ${a}`}}),p(n=>n.filter(c=>c._id!==g)),o(!1),C({message:"Plan deleted successfully.",severity:"success"})}catch(a){C({message:((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.message)||"Delete failed!",severity:"error"})}},E=[{field:"title",headerName:"Title",flex:2},{field:"price",headerName:"Price",flex:1,renderCell:t=>`â‚¹ ${t.value}`},{field:"duration",headerName:"Duration",flex:1,renderCell:t=>`${t.value} month${t.value>1?"s":""}`},{field:"description",headerName:"Description",flex:3},{field:"action",headerName:"Actions",flex:1.5,sortable:!1,filterable:!1,renderCell:t=>{const s=()=>{l(`/PlanList/${t.row._id}`)},a=()=>{l(`/PlanList/PlanEdit/${t.row._id}`)};return e.jsxs(e.Fragment,{children:[e.jsx(d,{title:"View",children:e.jsx(f,{onClick:s,children:e.jsx(F,{sx:{color:"#1976d2"}})})}),e.jsx(d,{title:"Edit",children:e.jsx(f,{onClick:a,children:e.jsx(L,{sx:{color:"#ffa000"}})})}),e.jsx(d,{title:"Delete",children:e.jsx(f,{onClick:()=>{b(t.row._id),A(t.row._id)},children:e.jsx(V,{sx:{color:"#d32f2f"}})})})]})}}];return e.jsxs(e.Fragment,{children:[e.jsxs(z,{sx:{p:3},children:[e.jsxs(B,{direction:{md:"row"},rowGap:2,justifyContent:"space-between",alignItems:{md:"center"},mb:2,children:[e.jsx(y,{variant:"h5",color:"primary.dark",children:"All Plans"}),e.jsx(h,{sx:{fontWeight:400},variant:"contained",onClick:()=>{l("/CreatePlan")},children:"Create Plan"})]}),w?e.jsx(N,{textAlign:"center",children:e.jsx(_,{})}):x?e.jsx(y,{color:"error.main",children:x}):e.jsx(R,{rows:k.map(t=>({...t,id:t._id})),columns:E,apiRef:I,initialState:{pagination:{paginationModel:{pageSize:10,page:0}}}})]}),e.jsxs(H,{open:S,onClose:v,children:[e.jsx(M,{children:"Delete Plan"}),e.jsx(O,{children:e.jsx(W,{children:"Are you sure you want to delete this plan? This action cannot be undone."})}),e.jsxs(q,{children:[e.jsx(h,{onClick:v,children:"Cancel"}),e.jsx(h,{onClick:T,color:"error",variant:"contained",children:"Confirm Delete"})]})]}),e.jsx(J,{open:r.open,autoHideDuration:6e3,onClose:D,anchorOrigin:{vertical:r.vertical,horizontal:r.horizontal},children:e.jsx(K,{onClose:D,severity:r.severity,variant:"filled",sx:{width:"100%"},children:r.message})},r.vertical+r.horizontal)]})};export{de as default};
