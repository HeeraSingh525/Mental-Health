import{r as t,j as a,P as $,S as E,T as g,w as z,x as R}from"./index-Dbp6cY2J.js";import{S as W,C as k}from"./CustomPagination-CmLdiBRs.js";import{u as D,D as I}from"./DataGrid-B0QCrr4f.js";import"./IconifyIcon-CVzshvhH.js";import"./TextField-CHFAi5Wa.js";import"./Menu-BX0TDKzG.js";import"./Toolbar-Cy1yNAeb.js";import"./Divider-BnrKH_WB.js";import"./InputAdornment-BYBFXy2L.js";import"./Button-BL7aqzdx.js";import"./Checkbox-COksgwjS.js";import"./colorManipulator-DQXk7iNs.js";const K=()=>{const[f,c]=t.useState(!1),[x,S]=t.useState([]),[r,d]=t.useState(0),[s,b]=t.useState(5),[j,w]=t.useState(0),[l,y]=t.useState(""),i=D(),[m,C]=t.useState(""),v=[{field:"userName",headerName:"Name",width:150},{field:"userEmail",headerName:"Email",flex:1,minWidth:230},{field:"price",headerName:"Price",flex:1,minWidth:70,renderCell:e=>`â‚¹ ${e.value}`},{field:"duration",headerName:"Duration",flex:1.5,minWidth:200,renderCell:e=>`${e.value} month${e.value>1?"s":""}`},{field:"description",headerName:"Description",flex:1.5,minWidth:200}],N=async(e=r,o=s,P=l)=>{var p,u;c(!0);try{const n=localStorage.getItem("authToken"),h=await R.get(`http://172.236.30.193:8008/api/subscriber?page=${e+1}&limit=${o}&search=${P}`,{headers:{Authorization:`Bearer ${n}`}});S(h.data.data),w(h.data.total)}catch(n){C(((u=(p=n.response)==null?void 0:p.data)==null?void 0:u.message)||"Failed to fetch users")}finally{c(!1)}};return t.useEffect(()=>{N()},[r,s,l]),a.jsxs($,{sx:{p:3},children:[a.jsxs(E,{direction:{md:"row"},rowGap:2,justifyContent:"space-between",alignItems:{md:"center"},children:[a.jsx(g,{variant:"h4",color:"primary.dark",children:"Subscriber Management"}),a.jsx(W,{apiRef:i,sx:{maxWidth:300},onChange:e=>{const o=e.target.value;y(o),d(0)}})]}),a.jsx(z,{sx:{height:420,width:1,mt:3},children:a.jsx(I,{apiRef:i,rows:x,columns:v,loading:f,pageSizeOptions:[5,10],paginationMode:"server",paginationModel:{page:r,pageSize:s},onPaginationModelChange:e=>{d(e.page),b(e.pageSize)},rowCount:j,getRowId:e=>e.planId})}),a.jsx(k,{apiRef:i}),m&&a.jsx(g,{mt:2,color:"error.main",children:m})]})};export{K as default};
